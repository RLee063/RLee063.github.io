---
layout: post

title: "物联网安全相关解决方案"

---

一、国内外研究现状

1.1 与项目研究内容紧密相关的技术发展历史的简要回顾；

安全监测技术是保护终端设备安全的常用技术之一。安全监测技术通过实时采集设备运行时产生的通讯流量数据、流程业务数据和程序运行数据等，对设备所处的状态进行判断，判断设备处于正常状态还是异常状态，进而进行告警或者异常阻断，从而实现对设备安全的防护。传统的安全监测方法难以完全应对电网场景。传统的安全监测的方法通常基于人工规则和知识库，对专家的知识有较强的依赖性，如果专家经验不足容易引入新的安全问题。而且传统的安全监测方法需要人工收集已有的攻击特征，构建异常监测的知库，需要投入大量的人力。同时基于人工规则的异常检测方法需要不断迭代优化，根据新产生的攻击和新发现的漏洞来人工更新规则库，但电网存在的攻击多为零日攻击或者利用了尚未发现的漏洞，因此基于人工规则的异常检测方法难以完全应对电网场景。机器学习技术将显著提升安全攻击分析和监测方法的效果。当前，网络安全逐步向动态防御和主动防御演进，机器学习技术针对传统安全防护手段不能识别新型攻击和需要投入大量人力分析的弊端，通过其强大的安全威胁快速识别、反应及自主学习能力，对攻击进行深层次分析，挖掘潜在攻击特征，不断进行学习以适应新型、复杂度越来越高的网络攻击，同时能够有效降低分析、监测成本等，具有较优异效果，为解决电网攻击辨识评估问题提供了新的解决思路。

1.2 国内外研究水平的现状和发展趋势；

2016年11月，美国国土安全部（DHS）发布了《物联网安全指导原则》，其中包括了设计安全、漏洞管理和修复、最佳安全实践的采用、利用风险管理聚焦优先事务、供应链透明性以及持续连接的必要性判定等六项指导性原则。以上安全框架和指导原则的主要目的在于给物联网硬件设备生产商、软件系统开发商以及物联网系统管理员提供有关设计、制造和部署物联网设备时应该遵守的安全建议，然而没有形成一套完整的安全技术规范，也没有涉及对具体的网络攻击和安全技术的研究。除官方组织和学术研究机构外，各大安全厂商也在进行物联网安全技术的研究工作。对于工业物联网系统，知名安全厂商赛门铁克公司提供了两类解决方案，一是帮助管理人员保护工业物联网系统中基础设施的安全，二是帮助物联网设备供应商提高其产品的安全性。赛门铁克联合全球最大的芯片提供商德州仪器公司，以及密码服务提供商wolfSSL公司，将认证技术、加密技术以及嵌入式技术结合到一起，为物联网设备提供可靠的信息加密和身份验证。

近年来，物联网在我国的发展已经进入多行业落地阶段，同时也开始进入物联网安全建设阶段，相关科研单位及安全厂商都在积极探索物联网安全规范与技术[16]。国内知名安全厂商北京匡恩网络科技有限公司在2016年发布了《2016年度物联网安全研究报告》，该报告整体上对物联网及工业物联网的安全现状、安全保护技术及产业发展趋势进行了阐述。在2017年，中国电信联合北京神州绿盟信息安全科技有限公司发布了《2017 物联网安全研究报告》，该报告主要分析了2017年物联网存在的安全事件及相关恶意软件，提出物联网安全需求和安全体系结构。

1.3 介绍国外研究机构或者公司对本项目的研究情况；

来自新南威尔士大学和悉尼大学的Kim等人采取形式化方法对物联网协议拒绝服务攻击进行分析，说明绝大多数的物联网协议都很容易受到类似资源耗尽的攻击，并提出一种针对DoS攻击的防御对策。来自印度尼西亚万隆理工学院的Syaiful Andy等人指出基于MQTT协议通信的物联网系统没有实施足够的安全机制，还演示了针对在1883端口上通信的MQTT协议的攻击实例。来自印度TCS Innovation Labs的Meena Singh等人提出了一个安全版本的MQTT协议和 MQTT-SN 协议（SMQTT 和MQTT-SN），可以确保设备和D2D通信的安全。来自朴次茅斯大学的Paul Fremantle等人将OAuth2.0作为MQTT协议流程的一部分，实现了物联网系统中的联合身份和访问管理。来自泰国国家科学技术发展局的Aimaschana Niruntasukrat等人在Paul Fremantle的工作基础上，针对使用 MQTT 协议的物联网系统，设计实现了基于 OAuth 1.0a 的授权方案。此外，研究发现蓝牙、Zigbee和Z-Wave协议也存在诸多安全问题。许多技术人员与研究人员在blackhat会议发表自己的研究发明。Mike Ryan等人于2013年发表了文章阐述他们的研究成果：发现蓝牙的密钥交换协议中存在严重的缺陷，这使得攻击者能够被动地恢复会话加密密钥。同年，Behrang Fouladi设计了一种用于截获Z-Wave通信的工具Z-Force，并对Z-Wave协议的认证、加密和密钥交换过程进行分析，发现了一个针对S0框架的密钥交换协议实现的漏洞，攻击者可以在不知道加密密钥的情况下远程打开门锁。Tobias Zillner等人也在2015年的blackhat会议上阐述了自己的研究发现，利用SecBee框架分析了ZigBee Pro Home Automation (ZHA)和ZLL概要文件的安全措施，发现了大量协议漏洞和实现缺陷。虽然Z-Wave更新了安全标准（S2框架）但Pen Test Partners公司的安全研究员发现发现了Z-Wave降级攻击（Z-Shave），可以将S2降级为S0 进行相应的攻击。

1.4 介绍国内其他研究单位对本项目的研究情况。

近年来，物联网在我国的发展已经进入多行业落地阶段，同时也开始进入物联网安全建设阶段，相关科研单位及安全厂商都在积极探索物联网安全规范与技术。国内知名安全厂商北京匡恩网络科技有限公司在2016年发布了《2016年度物联网安全研究报告》，该报告整体上对物联网及工业物联网的安全现状、安全保护技术及产业发展趋势进行了阐述。在 2017 年，中国电信联合北京神州绿盟信息安全科技有限公司发布了《2017物联网安全研究报告》，该报告主要分析了2017年物联网存在的安全事件及相关恶意软件，提出物联网安全需求和安全体系结构。来自杭州科技职业技术学院和浙江大学的杨悦梅、宋执环在论文中分析了工业物联网在工业项目中的具体应用，以及工业物联网在全面感知层、可靠传输层、智能处理层存在安全风险，并提出了业务认证机制、加密机制、隐私保护等技术。来自江南计算技术研究所的郭莉、严波、沈延在论文中分析物联网系统所面临的安全威胁和安全需求，基于物联网系统传统架构提出了一套系统安全加固方案，包括将密码芯片内置在终端设备中，为信息处理中心设置密码机，通过数据安全网关将信息处理中心和互联网进行隔离，通过认证和加密机制保护数据的真实性、完整性和机密性，访问控制机制能够阻断互联网中对物联网内部资源的非法访问。

二、研究目的和意义

智能电网是重要的国家基础设施，加强智能电网信息安全建设是保障智能电网安全平稳运行重要保障。电力物联网终端设备安全是智能电网安全防护的重要部分。在电力物联网中，各类智能终端，如配电终端、智能电表、电力移动作业终端等设备对于保障电力供应、保证电力质量、提高输电效率等具有重要的作用。随着电网规模的扩张，各类电力物联网终端设备迅速增加，电网边缘出现了一些暴露在监测现场、调度数据网延伸不到而且不在调度数据网和信息内外网边界防护范围内的电力物联网终端设备。这些设备可能成为攻击者的目标或跳板，而且传统安全防护手段难以识别和防御新形势下高隐蔽性的复杂电网攻击行为。

电力物联网终端面临的安全风险在电网快速建设与发展的背景下不断增加。随着电网规模的不断扩大，电网环节和业务不断增多，终端设备种类众多、数量庞大且分布广泛，使得智能电网的边界模糊化，电网从一个完全独立、封闭的数据交互集中系统向智能边缘化方向发展，现场设备逐渐成为攻击者恶意攻击的目标。配电终端、电动汽车充电桩等物联网终端设备作为信息系统的底层边缘设备，直接实现对物理系统和环境的测量、监视、控制等功能，是信息物理系统闭环的关键节点，一旦遭到攻击，可能对生产过程产生严重的影响。

另一方面，针对物联网设备和通信协议的攻击也层出不穷。目前对于物联网平台协议的分析集中于研究各协议的适用性、分析协议本身的安全性以及对通信协议进行流量分析等多个方面。针对协议适用性，多数研究通过分析物联网平台的需求和架构不同，从性能和时延等多角度比较不同应用协议的优缺点。

不同于单一设备上出现的设备固件漏洞或智能应用中的缺陷，物联网协议中安全问题影响更加广泛。用户、物联网云端以及物联网设备间的通信安全无疑是物联网安全的基础，目前针对此方向的研究提出各自的解决方案，对本文有一定的借鉴意义，但也存在一定的局限。因此如何解决物联网场景的特殊性、建立统一的安全模型以及解决物联网中的密文流量具有重要研究意义。

三、研究项目的理论和实践依据

3.1 项目研究内容的原理简述；

随着时间的推移，从搜集远程设备信息的简单网络到内置冗余设备的复杂网络，智能电网协议的发展进程从未停歇。而且智能电网等系统内部所使用的协议有时只是针对某个特定的程序。多年来，众多的标准化组织（IEC，ISO等）都在致力于电网协议的标准化研究。同时，大量的专有协议的开始出现。在大多数情况下，专有协议是由厂家设计开发，并结合特定的软硬件构建以厂商为中心的系统。但这些协议存在的一个共同问题是在设计之初都没有考虑到随之而来的安全问题。而理解这些安全缺陷和如何利用这些缺陷，对电力物联网协议的安全测试非常重要。

模糊测试（Fuzzing），是一种通过向目标系统提供非预期的输入并监视异常结果来发现软件漏洞的方法。在对电力物联网终端协议进行安全模糊测试时,主要使用的是自动或半自动的检测技术,该技术能够有效对操作系统、代码以及软件的问题进行检测,尤其是对软件的脆弱性进行检测,帮助相关人员掌握软件中存在的漏洞,提升应用软件的运作的安全性。在开展协议安全模糊测试作业时,其流程主要是进行设备的接入,配置相关文件,运行安全模糊测试工具,对目标系统、软件进行全面识别,确定输入文件,产生模糊数据,再以此为基础执行测试工作,对目标系统和软件的行为进行监控,掌握并记录暴露的缺陷,最后对测试结果进行反馈。一般情况下,在开展协议安全模糊测试工作时,所采用的工具一般是AFL,所谓AFL,其主要是一款基于覆盖引导的模糊测试工具,通过对输入样本代码的覆盖率进行记录,通过对样本进行调节能够有效提升代码的覆盖率,进而及时发现系统漏洞。

3.2 项目研究内容的理论或者实践依据；

物联网协议实现中存在的具体安全风险包含：（1）身份认证。当物联网终端连接至物联网云端时，物联网云端会检查其身份的合法性和唯一性，防止攻击者冒充正常用户或伪造物联网设备登录连接物联网云端。物联网云端通常用devId和userId来识别设备和用户；（2）访问控制。物联网云端对用户和设备发送的绑定请求进行响应，并维护用户和设备之间的绑定关系。在此过程中，物联网云端赋予用户对设备的唯一控制权。当用户选择解除设备绑定时，物联网云将解除设备绑定并撤销相应的权限；（3）通信安全。在用户应用程序、物联网设备和物联网云端三者通信过程中，数据通过多种协议进行传输，数据通信存在着明文传输、重放攻击、篡改数据等风险。因此，保障通信数据的安全成为物联网协议安全的重要一环。

深度学习技术将显著提升安全攻击分析和监测方法的效果。当前，网络安全逐步向动态防御和主动防御演进，深度学习技术针对传统安全防护手段不能识别新型攻击和需要投入大量人力分析的弊端，通过其强大的安全威胁快速识别、反应及自主学习能力，对攻击进行深层次分析，挖掘潜在攻击特征，不断进行学习以适应新型、复杂度越来越高的网络攻击，同时能够有效降低分析、监测成本等，具有较优异效果，为解决电网攻击辨识评估问题提供了新的解决思路。

3.3 项目研究的关键和难点。

异质性：物联网包括许多来自不同家庭的设备，包括传感器、智能设备、移动系统、网关等。这些设备使用不同的通信协议，并在不同的系统上运行，并使用不同的算法进行数据处理。

可扩展性：物联网中出现的传统网络面临着前所未有的挑战，包括数百万个需要服务、管理、命名和寻址的节点。

通信：物联网设备使用了多种技术，包括无线通信，如Zig-Bee、MQTT、蓝牙以及有线通信。

能耗：由于大多数物联网节点都是有限的资源，因此能耗是物联网中的主要问题。发明任何一种在物联网节点上运行的算法都应该具有较低的复杂性，以获得轻量级规范。

数据隐私：某些特定使用场景的用户数据隐私可能是物联网中的一个问题。为了说明，在公共模式操作中，可以在需要时向包括系统管理员在内的其他周围机器提供物联网对象的位置信息。然而，如果他们处于私人模式操作，位置细节可能会保密，以保护他们自己位置细节的隐私。

自我意识：一些预先确定的特定任务需要完成，并且在真实环境中没有人为干扰的情况下，物联网智能节点应该自我组织以执行此类活动。

互操作性：数据共享的格式应标准化并预先确定，以允许异构节点与其他物联网节点交互、协作和共享数据。

此外，物联网中的无线传感器网络架构由于各种因素，包括不可靠的链路、缺乏基础设施、动态拓扑、有限的物理安全和资源限制，对网络安全提出了许多挑战和担忧。这些&quot;东西&quot;由于其脆弱性，必须受到内部或外部威胁的保护。

3.4 项目创新点

强化学习是软件测试领域一个很有前途的研究方向。我们希望能够能够基于强化学习利用二进制通用模糊技术来进行物联网终端的安全性分析与漏洞挖掘。而且还可以定义一个测试环境，允许用户将他们的模糊想法框定为一个强化学习公式，以及定义用于训练和使用该环境的强化学习方法。

四、项目研究内容和实施方案

4.1 项目研究内容的详细说明

能够基于强化学习利用二进制通用模糊技术来进行物联网终端的安全性分析与漏洞挖掘。能够从不同的维度定制强化学习环境，基本过程可以表示为:状态表示、行动和奖励定制、模型选择和训练算法；允许有状态的程序测试，也就是说，被测试的程序是在一个输入序列下计算的，所以不需要每次都重置程序的状态；还可以将经典的前向跟踪流程与符号约束传播相结合。

在使用该模糊检测工具开展电力物联网终端通信协议检测时,应做好准备工作,具体内容为:第一,明确检测目标。对于电力物联网终端通信协议检测项目而言,主要是基于输变电设备物联网传感器数据规范的模糊数据测试,主要对边缘物联代理及传感器等进行模糊测试,根据测试结果对配置文件进行合理修改,并记录边缘物联代理响应,从而掌握边缘物联代理微应用性能。第二,对语料库进行构建。在使用AFL工具时,需要输入种子文件,在输入时应选择尽量小的体积,这主要是为了有效缩短数据处理时间,进而提高检测效率。另外,虽然种子文件的数据可以是无意义的,但在开展实际的检测作业时,应尽量进行有效输入,这是因为有效输入不仅能够快速找到多条执行路径,还能够避免bug的产生。保证消费者物联网平台中的用户无法接触物联网设备的设计以及实现过程，普通用户和设备拥有终端接入、终端交互和终端停用的完整过程。用户、备与平台的角色相互独立，通过特定的协议实现三者的交互通信。

4.2 具体的理论研究步骤和其中所用到的技术路线技术栈

1.定义模糊测试环境。可以用典型的强化学习公式来构建模糊问题。使用标准的OpenAI Gym环境规范；

2.深度Q-Learning模型：处理来自运行/调试系统的系统状态，生成奖励，决定下一步的行动；

3.定义状态：标记输入，使用特定符号表示各个对应状态；

4.定义行为：将马尔可夫决策过程的可能动作集合定义为将输入的子串映射到概率重写规则的随机变量；

5.奖励回馈：独立地定义了以下两种特征的奖励:1)下一个执行的动作和2)用下一个生成的输入执行的程序；

6.初始化：对初始种子程序输入和Q function进行初始化；

7.状态提取：输入一种子程序，输出一个新的状态集，此集合应为状态集子集；

8.行为选择：输入当前Q function，观察状态变化，输出一个新的行为集；

9.突变：以一个种子程序和一个行为作为输入，输出通过应用该行为在该程序上生成的字符串；

10.奖励评估：奖励评估步骤以目标程序、行为和程序输入作为输入，这些输入都是由应用程序在种子程序上生成的；

11.Q Update：构造一个由非线性激活函数连接的四层前馈神经网络来实现Q-earning模块，个隐藏层包含64到180个隐藏单元，用tanh激活函数，梯度下降优化器的初始学习率设置为0.02；

![](RackMultipart20211118-4-ztfjds_html_2f93257b6756bb7d.png)